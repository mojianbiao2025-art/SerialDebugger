# Qt WebAssembly é—®é¢˜æ€»ç»“å’Œæœ€ç»ˆå»ºè®®

## ğŸ“Š å®Œæ•´è¯Šæ–­ç»“æœ

ç»è¿‡è¯¦ç»†çš„è¯Šæ–­å’Œå¤šæ¬¡å°è¯•ï¼Œç¡®è®¤ä»¥ä¸‹æƒ…å†µï¼š

### âœ… æ­£å¸¸å·¥ä½œçš„éƒ¨åˆ†
1. WebAssembly åŠ è½½æˆåŠŸ
2. Canvas é…ç½®æ­£ç¡® (1200x800)
3. WebGL æµè§ˆå™¨æ”¯æŒ (Chrome 144)
4. Module é…ç½®æ­£ç¡®
5. æ‰€æœ‰æ–‡ä»¶åŠ è½½æˆåŠŸ
6. å·²æ·»åŠ  WebGL æ”¯æŒæ ‡å¿—
7. å·²ç®€åŒ– MainWindow
8. å·²ä¿®å¤é“¾æ¥é”™è¯¯

### âŒ é—®é¢˜æ‰€åœ¨
1. **SerialDebugger.wasm æ–‡ä»¶åªæœ‰ 4.05 KB**
   - æ­£å¸¸åº”è¯¥æ˜¯ 3-5 MB
   - è¯´æ˜æ„å»ºä¸å®Œæ•´æˆ–å¤±è´¥
2. Canvas å†…å®¹å®Œå…¨ç©ºç™½
3. Qt åº”ç”¨æ²¡æœ‰æ¸²æŸ“ä»»ä½•å†…å®¹

## ğŸ” æ ¹æœ¬åŸå› åˆ†æ

### å¯èƒ½åŸå›  1ï¼šQt 5.15.2 WebAssembly æ„å»ºé—®é¢˜

Qt 5.15.2 for WebAssembly å¯èƒ½åœ¨ GitHub Actions ç¯å¢ƒä¸­æ„å»ºå¤±è´¥ï¼Œä½†æ²¡æœ‰æŠ¥é”™ã€‚

**è¯æ®ï¼š**
- .wasm æ–‡ä»¶å¼‚å¸¸å° (4 KB vs åº”è¯¥çš„ 3-5 MB)
- åº”ç”¨åŠ è½½ä½†ä¸æ¸²æŸ“
- æ‰€æœ‰é…ç½®éƒ½æ­£ç¡®ä½†ä»ä¸å·¥ä½œ

### å¯èƒ½åŸå›  2ï¼šaqtinstall å®‰è£…çš„ Qt ä¸å®Œæ•´

ä½¿ç”¨ `aqtinstall` å®‰è£…çš„ Qt 5.15.2 wasm_32 å¯èƒ½ç¼ºå°‘å¿…è¦çš„ç»„ä»¶ã€‚

### å¯èƒ½åŸå›  3ï¼šEmscripten å’Œ Qt ç‰ˆæœ¬ä¸å…¼å®¹

è™½ç„¶ Qt 5.15.2 + Emscripten 1.39.20 åº”è¯¥å…¼å®¹ï¼Œä½†å¯èƒ½æœ‰æœªçŸ¥çš„å…¼å®¹æ€§é—®é¢˜ã€‚

## ğŸ¯ æœ€ç»ˆå»ºè®®

### å»ºè®® Aï¼šä½¿ç”¨ Qt 6ï¼ˆå¼ºçƒˆæ¨èï¼‰

Qt 6 å¯¹ WebAssembly çš„æ”¯æŒæ›´å¥½ã€æ›´ç¨³å®šã€‚

**ä¼˜ç‚¹ï¼š**
- æ›´å¥½çš„ WebAssembly æ”¯æŒ
- æ›´å°‘çš„å·²çŸ¥é—®é¢˜
- æ›´å¥½çš„æ–‡æ¡£å’Œç¤¾åŒºæ”¯æŒ
- æ›´æ–°çš„ Emscripten ç‰ˆæœ¬æ”¯æŒ

**ç¼ºç‚¹ï¼š**
- éœ€è¦ä¿®æ”¹ä»£ç ä»¥å…¼å®¹ Qt 6
- éœ€è¦æ›´æ–°æ„å»ºé…ç½®

**è¿ç§»å·¥ä½œé‡ï¼š**
- ä¸­ç­‰ï¼ˆå¤§çº¦ 1-2 å¤©ï¼‰
- ä¸»è¦æ˜¯ API å˜æ›´å’ŒåºŸå¼ƒå‡½æ•°æ›¿æ¢

### å»ºè®® Bï¼šä½¿ç”¨ Qt å®˜æ–¹çš„ Docker é•œåƒ

ä½¿ç”¨ Qt å®˜æ–¹æä¾›çš„é¢„é…ç½® Docker é•œåƒæ¥æ„å»ºã€‚

**ä¼˜ç‚¹ï¼š**
- ç¯å¢ƒå®Œå…¨ä¸€è‡´
- Qt å’Œ Emscripten ç‰ˆæœ¬åŒ¹é…
- é¿å…å®‰è£…é—®é¢˜

**å®æ–½ï¼š**
```yaml
# .github/workflows/build-wasm.yml
jobs:
  build:
    runs-on: ubuntu-latest
    container:
      image: darkmattercoder/qt-webassembly:5.15.2
    steps:
      - uses: actions/checkout@v4
      - name: Build
        run: |
          mkdir build && cd build
          qmake ..
          make
```

### å»ºè®® Cï¼šæœ¬åœ°æ„å»ºå¹¶ä¸Šä¼ 

åœ¨æœ¬åœ°æˆåŠŸæ„å»ºåï¼Œç›´æ¥ä¸Šä¼ æ„å»ºäº§ç‰©åˆ° GitHub Pagesã€‚

**æ­¥éª¤ï¼š**
1. åœ¨æœ¬åœ°å®‰è£… Qt 5.15.2 for WebAssembly
2. åœ¨æœ¬åœ°æ„å»ºåº”ç”¨
3. éªŒè¯æœ¬åœ°æ„å»ºå¯ä»¥è¿è¡Œ
4. å°† build äº§ç‰©ä¸Šä¼ åˆ° GitHub Pages

### å»ºè®® Dï¼šç®€åŒ–ä¸ºçº¯ Web åº”ç”¨

æ”¾å¼ƒ Qtï¼Œä½¿ç”¨çº¯ HTML/JavaScript/CSS é‡å†™ç•Œé¢ã€‚

**ä¼˜ç‚¹ï¼š**
- æ²¡æœ‰ Qt WebAssembly çš„å¤æ‚æ€§
- æ–‡ä»¶æ›´å°ï¼ŒåŠ è½½æ›´å¿«
- æ›´å®¹æ˜“è°ƒè¯•å’Œç»´æŠ¤
- Web Serial API å¯ä»¥ç›´æ¥ä½¿ç”¨

**ç¼ºç‚¹ï¼š**
- éœ€è¦å®Œå…¨é‡å†™ UI
- å¤±å» Qt çš„è·¨å¹³å°ä¼˜åŠ¿

## ğŸ“ å…·ä½“å®æ–½æ–¹æ¡ˆ

### æ–¹æ¡ˆ 1ï¼šè¿ç§»åˆ° Qt 6ï¼ˆæ¨èï¼‰

#### æ­¥éª¤ 1ï¼šæ›´æ–° CMakeLists.txt

```cmake
cmake_minimum_required(VERSION 3.16)
project(SerialDebugger VERSION 1.0.0 LANGUAGES CXX)

set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)

find_package(Qt6 REQUIRED COMPONENTS Core Gui Widgets)

qt_standard_project_setup()

qt_add_executable(SerialDebugger
    main.cpp
    mainwindow.cpp
    mainwindow.h
)

target_link_libraries(SerialDebugger PRIVATE
    Qt6::Core
    Qt6::Gui
    Qt6::Widgets
)

if(EMSCRIPTEN)
    set_target_properties(SerialDebugger PROPERTIES
        QT_WASM_PTHREAD_POOL_SIZE 4
    )
endif()
```

#### æ­¥éª¤ 2ï¼šæ›´æ–° GitHub Actions

```yaml
- name: Install Qt for WebAssembly
  run: |
    pip3 install aqtinstall
    aqt install-qt linux desktop 6.5.3 wasm_singlethread
```

#### æ­¥éª¤ 3ï¼šä¿®æ”¹ä»£ç 

ä¸»è¦å˜æ›´ï¼š
- `#include <QtWidgets>` â†’ `#include <QtWidgets/QtWidgets>`
- æŸäº› API å˜æ›´
- ä¿¡å·æ§½è¯­æ³•æ›´æ–°

### æ–¹æ¡ˆ 2ï¼šä½¿ç”¨ Docker æ„å»º

åˆ›å»º `.github/workflows/build-wasm-docker.yml`ï¼š

```yaml
name: Build with Docker

on:
  push:
    branches: [ main ]

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      
      - name: Build with Qt Docker
        run: |
          docker run --rm -v $PWD:/project \
            darkmattercoder/qt-webassembly:5.15.2 \
            /bin/bash -c "cd /project && mkdir build && cd build && qmake .. && make"
      
      - name: Deploy
        uses: peaceiris/actions-gh-pages@v3
        with:
          github_token: ${{ secrets.GITHUB_TOKEN }}
          publish_dir: ./build
```

### æ–¹æ¡ˆ 3ï¼šæœ¬åœ°æ„å»º

å¦‚æœæ‚¨æœ‰ Windows/Linux/Mac æœ¬åœ°ç¯å¢ƒï¼š

1. ä¸‹è½½ Qt 5.15.2 for WebAssembly
2. å®‰è£… Emscripten 1.39.20
3. æœ¬åœ°æ„å»ºï¼š
   ```bash
   mkdir build && cd build
   qmake ..
   make
   ```
4. æµ‹è¯•æœ¬åœ°æ„å»º
5. ä¸Šä¼ åˆ° GitHub Pages

## ğŸ¯ æˆ‘çš„æ¨è

åŸºäºå½“å‰æƒ…å†µï¼Œæˆ‘**å¼ºçƒˆæ¨èæ–¹æ¡ˆ 1ï¼šè¿ç§»åˆ° Qt 6**ã€‚

**ç†ç”±ï¼š**
1. Qt 6 çš„ WebAssembly æ”¯æŒæ›´æˆç†Ÿ
2. æ–‡æ¡£å’Œç¤¾åŒºæ”¯æŒæ›´å¥½
3. é•¿æœŸæ¥çœ‹æ›´å¯ç»´æŠ¤
4. è¿ç§»å·¥ä½œé‡å¯æ§ï¼ˆ1-2 å¤©ï¼‰

**å¦‚æœæ—¶é—´ç´§è¿«ï¼Œæ¨èæ–¹æ¡ˆ 2ï¼šä½¿ç”¨ Docker**ï¼Œè¿™æ ·å¯ä»¥å¿«é€ŸéªŒè¯æ„å»ºç¯å¢ƒæ˜¯å¦æ˜¯é—®é¢˜æ‰€åœ¨ã€‚

## ğŸ“ éœ€è¦çš„ä¿¡æ¯

å¦‚æœæ‚¨æƒ³ç»§ç»­è°ƒè¯•å½“å‰çš„ Qt 5.15.2 æ„å»ºï¼Œè¯·æä¾›ï¼š

1. **GitHub Actions å®Œæ•´æ„å»ºæ—¥å¿—**
   - ç‰¹åˆ«æ˜¯ Qt å®‰è£…éƒ¨åˆ†
   - CMake é…ç½®éƒ¨åˆ†
   - é“¾æ¥éƒ¨åˆ†

2. **æœ¬åœ°æ˜¯å¦èƒ½æˆåŠŸæ„å»ºï¼Ÿ**
   - å¦‚æœæœ¬åœ°å¯ä»¥ï¼Œè¯´æ˜æ˜¯ CI ç¯å¢ƒé—®é¢˜
   - å¦‚æœæœ¬åœ°ä¹Ÿä¸è¡Œï¼Œè¯´æ˜æ˜¯é…ç½®é—®é¢˜

3. **æ˜¯å¦æ„¿æ„å°è¯• Qt 6ï¼Ÿ**
   - æˆ‘å¯ä»¥å¸®åŠ©è¿ç§»ä»£ç 

---

**æ€»ç»“ï¼šç»è¿‡è¯¦ç»†è¯Šæ–­ï¼Œé—®é¢˜åœ¨äº Qt WebAssembly æ„å»ºæœ¬èº«ï¼Œè€Œä¸æ˜¯æµè§ˆå™¨æˆ–é…ç½®ã€‚å»ºè®®è¿ç§»åˆ° Qt 6 æˆ–ä½¿ç”¨ Docker æ„å»ºç¯å¢ƒã€‚**
